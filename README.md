# AI Tourist Guide: RAG Pipeline with Reranking and Evaluation

## Описание
Разработка вопросно-ответной системы (RAG) на базе LLM, выступающей в роли виртуального гида по достопримечательностям (данные РФ и частично СНГ). 

Проект решает задачу генерации релевантных ответов на основе зашумленных данных, используя гибридный поиск и автоматизированную оценку качества генерации.

## Ключевые особенности
* **Data Cleaning:** Использование TF-IDF для выявления и фильтрации нерелевантных описаний (выбросов) в датасете.
* **Advanced RAG:** Реализация двухуровневого поиска:
    1.  Векторный поиск через **ChromaDB**.
    2.  Реранжирование (Reranking) результатов с помощью **ColBERTv2 (Ragatouille)** для повышения точности.
* **LLM:** Использование модели **Qwen/Qwen2.5-3B-Instruct** для генерации ответов.
* **Evaluation:** Реализация пайплайна оценки качества (RAGAS-like metrics):
    * *Answer Relevancy* (семантическая близость вопроса и ответа).
    * *Retrieval Recall* (точность поиска контекста).
    * *Faithfulness* (отсутствие галлюцинаций).

## Технологический стек
* **LLM & Embeddings:** HuggingFace, Sentence-Transformers (`distiluse-base-multilingual-cased-v2`), Qwen.
* **Vector Store:** ChromaDB.
* **Frameworks:** LangChain, Ragatouille.
* **Data Analysis:** Pandas, Scikit-learn (TF-IDF, PCA), UMAP (визуализация эмбеддингов).

## Этапы реализации
1.  **EDA и Препроцессинг:** Анализ датасета достопримечательностей, декодирование изображений, стратифицированная выборка для валидации.
2.  **Очистка данных:** Фильтрация мусорных описаний на основе частотности слов (TF-IDF).
3.  **Построение индекса:** Создание векторной базы знаний на основе очищенных описаний.
4.  **RAG Pipeline:** Настройка промптов и интеграция реранкера для улучшения контекста.
5.  **Визуализация:** Проекция векторного пространства с помощью PCA и UMAP для анализа кластеров данных.
6.  **Тестирование и Метрики:**
    * *Retrieval Recall:* ~0.89 (высокая точность поиска релевантных документов).
    * *Answer Relevancy:* ~0.62 (модель держит контекст вопроса).
    * *Анализ:* Выявлены проблемы с Faithfulness из-за краткости исходных описаний, возможные пути улучшения - data augmentation.

## Пример работы
**Вопрос:** *"Что можно рассказать туристу про Царский мост?"*
**Ответ RAG:** *"Царский мост в Екатеринбурге — это мост через реку Исеть с видом на здание и достопримечательность..."*

---
*Проект выполнен в рамках курса Deep Learning School 2.*
